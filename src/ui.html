<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
  </head>
  <body>
    <div class="tabs">
      <button class="tab active" data-tab="names">Names</button>
      <button class="tab" data-tab="addresses">Addresses</button>
      <button class="tab" data-tab="dates">Dates</button>
      <button class="tab hidden" data-tab="contact">Contact</button>
      <button class="tab" data-tab="images">Images</button>
    </div>

    <div class="content">
      <!-- NAMES TAB -->
      <div class="tab-panel active" data-panel="names">
        <div class="pill-card">Generate by <strong>clicking the button</strong> below or by <strong>selecting a text layer.</strong></div>
        <div class="form-group">
          <label>Gender</label>
          <div class="radio-group">
            <div class="radio-card">
              <input
                type="radio"
                id="gender-neutral"
                name="nameGender"
                value="neutral"
                checked
              />
              <label for="gender-neutral">Any</label>
            </div>
            <div class="radio-card">
              <input
                type="radio"
                id="gender-male"
                name="nameGender"
                value="male"
              />
              <label for="gender-male">Male</label>
            </div>
            <div class="radio-card">
              <input
                type="radio"
                id="gender-female"
                name="nameGender"
                value="female"
              />
              <label for="gender-female">Female</label>
            </div>
          </div>
        </div>

        <div class="form-group">
          <label>Language</label>
          <div class="radio-group">
            <div class="radio-card">
              <input
                type="radio"
                id="language-english"
                name="nameLanguage"
                value="english"
                checked
              />
              <label for="language-english"
                >English<br /><small style="opacity: 0.8"
                  >Sandeep Shrestha</small
                ></label
              >
            </div>
            <div class="radio-card">
              <input
                type="radio"
                id="language-nepali"
                name="nameLanguage"
                value="nepali"
              />
              <label for="language-nepali"
                >Nepali<br /><small style="opacity: 0.8"
                  >सन्दीप श्रेष्ठ</small
                ></label
              >
            </div>
          </div>
        </div>

        <div class="form-group">
          <label>Name Type</label>
          <div class="radio-group">
            <div class="radio-card">
              <input
                type="radio"
                id="name-type-full"
                name="nameType"
                value="full"
                checked
              />
              <label for="name-type-full">Full Name</label>
            </div>
            <div class="radio-card">
              <input
                type="radio"
                id="name-type-first"
                name="nameType"
                value="first"
              />
              <label for="name-type-first">First Name Only</label>
            </div>
          </div>
        </div>

        <div class="form-group">
          <label>
            <input
              type="checkbox"
              id="includeMiddleName"
              style="margin-right: 8px; transform: scale(1.2)"
            />
            Include Middle Name
          </label>
        </div>

        <div class="actions">
          <button onclick="generateName()" id="nameGenerateBtn">
            <span class="selectedLayerCount">Generate New Data</span>
          </button>
        </div>

        <!-- <div class="info-note">
          <span class="info-icon">ℹ️</span>
          <span class="info-text"
            >Select text layers to update, or create new if none selected</span
          >
        </div> -->
      </div>

      <!-- ADDRESSES TAB -->
      <div class="tab-panel" data-panel="addresses">
        <div class="pill-card">Generate by <strong>clicking the button</strong> below or by <strong>selecting a text layer.</strong></div>
        <div class="form-group">
          <label>Province (Optional)</label>
          <select id="addressProvince">
            <option value="">Any Province</option>
            <option value="Bagmati">Bagmati</option>
            <option value="Gandaki">Gandaki</option>
            <option value="Koshi">Koshi</option>
            <option value="Madhesh">Madhesh</option>
            <option value="Lumbini">Lumbini</option>
            <option value="Karnali">Karnali</option>
            <option value="Sudurpashchim">Sudurpashchim</option>
          </select>
        </div>

        <div class="actions">
          <button onclick="generateAddress()" id="addressGenerateBtn">
            <span class="selectedLayerCount">Generate New Data</span>
          </button>
        </div>

        <!-- <div class="info-note">
          <span class="info-icon">ℹ️</span>
          <span class="info-text"
            >Select text layers to update, or create new if none selected</span
          >
        </div> -->
      </div>

      <!-- DATES TAB -->
      <div class="tab-panel" data-panel="dates">
        <div class="pill-card">Generate by <strong>clicking the button</strong> below or by <strong>selecting a text layer.</strong></div>
        <div class="form-group">
          <label>Language</label>
          <div class="radio-group">
            <div class="radio-card">
              <input
                type="radio"
                id="date-lang-english"
                name="dateLanguage"
                value="english"
                checked
              />
              <label for="date-lang-english"
                >English<br /><small style="opacity: 0.8"
                  >15 Ashar 2078 BS</small
                ></label
              >
            </div>
            <div class="radio-card">
              <input
                type="radio"
                id="date-lang-nepali"
                name="dateLanguage"
                value="nepali"
              />
              <label for="date-lang-nepali"
                >Nepali<br /><small style="opacity: 0.8"
                  >२०७८ साल असर १५ गते</small
                ></label
              >
            </div>
          </div>
        </div>

        <div class="form-group">
          <label>Format</label>
          <div class="radio-group">
            <div class="radio-card">
              <input
                type="radio"
                id="date-format-long"
                name="dateFormat"
                value="long"
                checked
              />
              <label for="date-format-long">Long <br /><small style="opacity: 0.8"
                  >15 Ashar 2078 BS</small>
              </label>
            </div>
            <div class="radio-card">
              <input
                type="radio"
                id="date-format-short"
                name="dateFormat"
                value="short"
              />
              <label for="date-format-short">Short <br /><small style="opacity: 0.8"
                  >Ashar 15, 2078</small>
              </label>
            </div>
            <div class="radio-card">
              <input
                type="radio"
                id="date-format-numeric"
                name="dateFormat"
                value="numeric"
              />
              <label for="date-format-numeric">Numeric <br /><small style="opacity: 0.8"
                  >2078/03/15</small>
              </label>
            </div>
          </div>
        </div>

        <div class="form-group">
          <label>
            <input
              type="checkbox"
              id="includeTime"
              style="margin-right: 8px; transform: scale(1.2)"
            />
            Include a time
          </label>
        </div>

        <div class="actions">
          <button onclick="generateNepaliDate()" id="dateGenerateBtn">
            <span class="selectedLayerCount">Generate New Data</span>
          </button>
        </div>

        <!-- <div class="info-note">
          <span class="info-icon">ℹ️</span>
          <span class="info-text"
            >Select text layers to update, or create new if none selected</span
          >
        </div> -->
      </div>

      <!-- CONTACT TAB -->
      <div class="tab-panel" data-panel="contact">
        <div class="form-group">
          <label>Phone Type</label>
          <select id="phoneType">
            <option value="mobile">Mobile (+977-98XXXXXXXX)</option>
            <option value="landline">Landline (+977-1-XXXXXXX)</option>
          </select>
        </div>

        <div class="form-group">
          <label>Currency Amount (NPR)</label>
          <input
            type="number"
            id="currencyAmount"
            placeholder="Leave empty for random"
            min="1"
          />
        </div>

        <div class="form-group">
          <label>Date Format</label>
          <select id="dateFormat">
            <option value="ad">AD (English)</option>
            <option value="bs">BS (Nepali)</option>
            <option value="both">Both</option>
          </select>
        </div>

        <div class="actions">
          <button onclick="generateContact()">Generate All</button>
        </div>

        <div class="info-note">
          <span class="info-icon">ℹ️</span>
          <span class="info-text"
            >Select text layers to update, or create new if none selected</span
          >
        </div>
      </div>

      <!-- IMAGES TAB -->
      <div class="tab-panel coming-soon-overlay" data-panel="images">
        <div class="overlay-content">
          <div class="form-group">
            <label>Face Type</label>
            <div class="form-row">
              <select id="imageGender">
                <option value="any">Any Gender</option>
                <option value="male">Male</option>
                <option value="female">Female</option>
              </select>
              <select id="imageAge">
                <option value="any">Any Age</option>
                <option value="young">Young (18-30)</option>
                <option value="middle">Middle (30-50)</option>
                <option value="senior">Senior (50+)</option>
              </select>
            </div>
          </div>

          <div class="form-group">
            <label>Style</label>
            <select id="imageStyle">
              <option value="photo">Photo-realistic</option>
              <option value="avatar">Avatar Style</option>
              <option value="minimal">Minimal</option>
            </select>
          </div>

          <div class="image-grid" id="imageGrid">
            <div class="image-item">Loading...</div>
            <div class="image-item">Loading...</div>
            <div class="image-item">Loading...</div>
          </div>

          <div class="actions">
            <button onclick="loadImages()">Load Images</button>
          </div>
        </div>

        <div class="coming-soon-message">
          <h3>Coming Soon!</h3>
          <p>Stay tuned for AI-generated Nepali faces</p>
        </div>
      </div>
    </div>

    <div class="footer">
      <div class="footer-version">v0.2.0</div>
      <div class="footer-attribution">
        Made by Space Chimp with <span class="heart-icon">♥️</span>
      </div>
    </div>

    <script>
      // ========================================================================
      // TAB MANAGEMENT
      // ========================================================================

      document.querySelectorAll(".tab").forEach((tab) => {
        tab.addEventListener("click", () => {
          const targetTab = tab.dataset.tab;

          // Update tab buttons
          document
            .querySelectorAll(".tab")
            .forEach((t) => t.classList.remove("active"));
          tab.classList.add("active");

          // Update panels
          document.querySelectorAll(".tab-panel").forEach((panel) => {
            panel.classList.remove("active");
          });
          document
            .querySelector(`[data-panel="${targetTab}"]`)
            .classList.add("active");
        });
      });

      // ========================================================================
      // MESSAGE HANDLING
      // ========================================================================

      window.onmessage = (event) => {
        const msg = event.data.pluginMessage;

        switch (msg.type) {
          case "selection-changed":
            updateSelectionInfo(msg.selection);
            break;
        }
      };

      function updateSelectionInfo(selection) {
        const infoTexts = document.querySelectorAll(".info-text");
        const selectedLayerCounts = document.querySelectorAll(".selectedLayerCount");

        const message =
          selection.count === 0
            ? "Select text layers to update, or create new if none selected"
            : `${selection.count} item(s) selected${
                selection.hasText ? " (includes text)" : ""
              }`;

        infoTexts.forEach((infoText) => {
          infoText.textContent = message;
        });

        selectedLayerCounts.forEach((selectedLayerCount) => {
          if (selection.count > 0 && selection.hasText) {
            selectedLayerCount.textContent = `Replace (${selection.count} data)`;
          }
          else if (selection.count > 0 && !(selection.hasText)){
            selectedLayerCount.textContent = `Select a text layer`;
          }
          else{
            selectedLayerCount.textContent = `Generate New Data`;
          }
        })
      }

      // ========================================================================
      // GENERATION FUNCTIONS
      // ========================================================================

      function generateName() {
        const gender = document.querySelector(
          'input[name="nameGender"]:checked'
        ).value;
        const language = document.querySelector(
          'input[name="nameLanguage"]:checked'
        ).value;
        const nameType = document.querySelector(
          'input[name="nameType"]:checked'
        ).value;
        const includeMiddleName =
          document.getElementById("includeMiddleName").checked;
        parent.postMessage(
          {
            pluginMessage: {
              type: "generate-name",
              gender,
              language,
              nameType,
              includeMiddleName,
              insert: true,
            },
          },
          "*"
        );
      }

      function generateAddress() {
        const province = document.getElementById("addressProvince").value;
        parent.postMessage(
          {
            pluginMessage: {
              type: "generate-address",
              province,
              insert: true,
            },
          },
          "*"
        );
      }

      function generateNepaliDate() {
        const language = document.querySelector(
          'input[name="dateLanguage"]:checked'
        ).value;
        const format = document.querySelector(
          'input[name="dateFormat"]:checked'
        ).value;
        const includeTime =
          document.getElementById("includeTime").checked;
        parent.postMessage(
          {
            pluginMessage: {
              type: "generate-nepali-date",
              language,
              format,
              includeTime,
              insert: true,
            },
          },
          "*"
        );
      }

      function generateContact() {
        const phoneType = document.getElementById("phoneType").value;
        const amount = document.getElementById("currencyAmount").value;
        const dateFormat = document.getElementById("dateFormat").value;

        // Generate each type
        parent.postMessage(
          {
            pluginMessage: { type: "generate-phone", phoneType, insert: true },
          },
          "*"
        );

        parent.postMessage(
          {
            pluginMessage: {
              type: "generate-currency",
              amount: amount || undefined,
              insert: true,
            },
          },
          "*"
        );

        parent.postMessage(
          {
            pluginMessage: {
              type: "generate-date",
              format: dateFormat,
              insert: true,
            },
          },
          "*"
        );
      }

      function loadImages() {
        const gender = document.getElementById("imageGender").value;
        const age = document.getElementById("imageAge").value;
        const style = document.getElementById("imageStyle").value;

        // Simulate loading images
        const grid = document.getElementById("imageGrid");
        grid.innerHTML = "";

        for (let i = 0; i < 6; i++) {
          const item = document.createElement("div");
          item.className = "image-item";
          item.textContent = `Face ${i + 1}`;
          item.onclick = () => selectImage(item);
          grid.appendChild(item);
        }
      }

      function selectImage(element) {
        document.querySelectorAll(".image-item").forEach((item) => {
          item.classList.remove("selected");
        });
        element.classList.add("selected");
      }

      // ========================================================================
      // UI INTERACTION LOGIC
      // ========================================================================

      // Handle middle name checkbox state based on name type
      document.querySelectorAll('input[name="nameType"]').forEach((radio) => {
        radio.addEventListener("change", function () {
          const middleNameCheckbox =
            document.getElementById("includeMiddleName");
          const isFirstNameOnly = this.value === "first";

          if (isFirstNameOnly) {
            middleNameCheckbox.checked = false;
            middleNameCheckbox.disabled = true;
            middleNameCheckbox.parentElement.style.opacity = "0.5";
          } else {
            middleNameCheckbox.disabled = false;
            middleNameCheckbox.parentElement.style.opacity = "1";
          }
        });
      });

      // ========================================================================
      // INITIALIZATION
      // ========================================================================

      // Load initial images
      setTimeout(loadImages, 1000);
    </script>
  </body>
</html>
